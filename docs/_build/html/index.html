
<!DOCTYPE html>

<html lang="python">
  <head>
    <meta charset="utf-8" />
    <title>Welcome to greypatch&#39;s documentation! &#8212; greypatch 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="welcome-to-greypatch-s-documentation">
<h1>Welcome to greypatch's documentation!<a class="headerlink" href="#welcome-to-greypatch-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
<span class="target" id="module-greypatch"></span><p>greypatch</p>
<p>A module for segmenting diseased leaf images to find healthy regions, lesion associated regions and lesion centres.</p>
<div class="section" id="workflow-overview">
<h2>Workflow Overview<a class="headerlink" href="#workflow-overview" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Set scale sliders to find HSV values that segment whole leaves from background</p></li>
<li><p>Segment image into leaf sub-images</p></li>
<li><p>Set scale sliders to find HSV values that segment healthy regions within leaf sub-images</p></li>
<li><p>Segment the healthy region</p></li>
<li><p>Set scale sliders to find HSV values that segment lesion regions within leaf sub-images</p></li>
<li><p>Segment the lesion regions</p></li>
<li><p>Set scale sliders that segment lesion centres within lesion regions</p></li>
<li><p>Segment lesion centres</p></li>
<li><p>Quantify found objects</p></li>
</ol>
</div>
<div class="section" id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Import module</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">greypatch</span> <span class="k">as</span> <span class="nn">rp</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Create an IPython file browser to select images</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">FileBrowser</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Load an image into HSV colour space</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hsv_image</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">load_as_hsv</span><span class="p">(</span> <span class="n">f</span><span class="o">.</span><span class="n">path</span> <span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Create an image slider</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rp</span><span class="o">.</span><span class="n">run_threshold_preview</span><span class="p">(</span><span class="n">hsv_image</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Find objects using HSV values</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># find raw objects</span>
<span class="n">lesion_region_mask</span><span class="p">,</span> <span class="n">lesion_region_volume</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">griffin_lesion_regions</span><span class="p">(</span><span class="n">cleared_image</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.82</span><span class="p">),</span>
                                                                                <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                                                                                <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="c1"># label regions</span>
<span class="n">labelled_lesion_regions</span><span class="p">,</span> <span class="n">lesion_region_count</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">label_image</span><span class="p">(</span><span class="n">lesion_region_mask</span><span class="p">)</span>

<span class="c1"># visual preview of regions</span>
<span class="n">rp</span><span class="o">.</span><span class="n">preview_object_labels</span><span class="p">(</span><span class="n">labelled_lesion_regions</span><span class="p">,</span> <span class="n">color</span><span class="o">.</span><span class="n">hsv2rgb</span><span class="p">(</span><span class="n">cleared_image</span><span class="p">))</span>

<span class="c1">#filter regions</span>
<span class="n">lesion_regions_properties_list</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">get_object_properties</span><span class="p">(</span><span class="n">labelled_lesion_regions</span><span class="p">)</span>
<span class="n">lesion_regions_to_keep</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">filter_region_property_list</span><span class="p">(</span><span class="n">lesion_regions_properties_list</span><span class="p">,</span> <span class="n">rp</span><span class="o">.</span><span class="n">is_not_small</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Examine objects as scikit-image measure RegionProps objects</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_lesion_region</span> <span class="o">=</span> <span class="n">lesion_regions_to_keep</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">first_lesion_region</span><span class="o">.</span><span class="n">area</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<dl class="py data">
<dt id="greypatch.HEALTHY_BLUE">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">HEALTHY_BLUE</code><em class="property"> = (0, 255)</em><a class="headerlink" href="#greypatch.HEALTHY_BLUE" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.HEALTHY_GREEN">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">HEALTHY_GREEN</code><em class="property"> = (120, 175)</em><a class="headerlink" href="#greypatch.HEALTHY_GREEN" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.HEALTHY_HUE">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">HEALTHY_HUE</code><em class="property"> = (0.1568627450980392, 1.0)</em><a class="headerlink" href="#greypatch.HEALTHY_HUE" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.HEALTHY_RED">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">HEALTHY_RED</code><em class="property"> = (4, 155)</em><a class="headerlink" href="#greypatch.HEALTHY_RED" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.HEALTHY_SAT">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">HEALTHY_SAT</code><em class="property"> = (0.19607843137254902, 1.0)</em><a class="headerlink" href="#greypatch.HEALTHY_SAT" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.HEALTHY_VAL">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">HEALTHY_VAL</code><em class="property"> = (0.0, 1.0)</em><a class="headerlink" href="#greypatch.HEALTHY_VAL" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.LEAF_AREA_HUE">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">LEAF_AREA_HUE</code><em class="property"> = (0.0, 1.0)</em><a class="headerlink" href="#greypatch.LEAF_AREA_HUE" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.LEAF_AREA_SAT">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">LEAF_AREA_SAT</code><em class="property"> = (0.19607843137254902, 1.0)</em><a class="headerlink" href="#greypatch.LEAF_AREA_SAT" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.LEAF_AREA_VAL">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">LEAF_AREA_VAL</code><em class="property"> = (0.1568627450980392, 1.0)</em><a class="headerlink" href="#greypatch.LEAF_AREA_VAL" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.LESION_HUE">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">LESION_HUE</code><em class="property"> = (0.0, 0.1607843137254902)</em><a class="headerlink" href="#greypatch.LESION_HUE" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.LESION_SAT">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">LESION_SAT</code><em class="property"> = (0.14901960784313725, 1.0)</em><a class="headerlink" href="#greypatch.LESION_SAT" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.LESION_VAL">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">LESION_VAL</code><em class="property"> = (0.43529411764705883, 1.0)</em><a class="headerlink" href="#greypatch.LESION_VAL" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.SCALE_CARD_HUE">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">SCALE_CARD_HUE</code><em class="property"> = (0.61, 1.0)</em><a class="headerlink" href="#greypatch.SCALE_CARD_HUE" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.SCALE_CARD_SAT">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">SCALE_CARD_SAT</code><em class="property"> = (0.17, 1.0)</em><a class="headerlink" href="#greypatch.SCALE_CARD_SAT" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py data">
<dt id="greypatch.SCALE_CARD_VAL">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">SCALE_CARD_VAL</code><em class="property"> = (0.25, 0.75)</em><a class="headerlink" href="#greypatch.SCALE_CARD_VAL" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for griffin named functions</p>
</dd></dl>

<dl class="py function">
<dt id="greypatch.clean_labelled_mask">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">clean_labelled_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label_array</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">region_props</span><span class="p">:</span> <span class="n">List<span class="p">[</span>skimage.measure._regionprops.RegionProperties<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#greypatch.clean_labelled_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes unwanted object pixels from a mask.</p>
<p>Given a label array, sets the labels not represented in region_props to Zero
removing them from the image. Intended to be used on label images</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>label_array np.ndarray -- the label array from which non-represented objects will be removed</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>region_props List -- list of skimage.measure.RegionProps, the objects to keep in the label array</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>np.ndarray -- cleaned label array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.clear_background">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">clear_background</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">img</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mask</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#greypatch.clear_background" title="Permalink to this definition">¶</a></dt>
<dd><p>given an image and a binary mask, clears all pixels in the image (ie sets to zero)
the zero/false pixels in the mask</p>
</dd></dl>

<dl class="py function">
<dt id="greypatch.extract_image_segment">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">extract_image_segment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hsv_img</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">region_prop</span><span class="p">:</span> <span class="n">skimage.measure._regionprops.RegionProperties</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#greypatch.extract_image_segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a rectangular segment of an image covering a region object.</p>
<p>Given 3D hsv_img returns a slice covered by the bounding box of region_prop</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>hsv_img np.ndarray -- an hsv scaled image</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>region_prop -- a RegionProps object describing the extent of the subimage</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.filter_region_property_list">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">filter_region_property_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">region_props</span><span class="p">:</span> <span class="n">List<span class="p">[</span>skimage.measure._regionprops.RegionProperties<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">func</span><span class="p">:</span> <span class="n">Callable<span class="p">[</span><span class="p">[</span>skimage.measure._regionprops.RegionProperties<span class="p">]</span><span class="p">, </span>bool<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>skimage.measure._regionprops.RegionProperties<span class="p">]</span><a class="headerlink" href="#greypatch.filter_region_property_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters region props objects from a list if they do not satisfy a condition.</p>
<p>Given a list of region props, and a function that returns True/False for each region prop
Returns a list of region props that have passed</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>region_props List -- list of skimage.measure.RegionProps objects</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>func Callable -- a function that returns True/False to be evaluated against the RegionProps objects</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of RegionProps</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.get_object_properties">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">get_object_properties</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label_array</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">intensity_image</span><span class="p">:</span> <span class="n">numpy.ndarray</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>skimage.measure._regionprops.RegionProperties<span class="p">]</span><a class="headerlink" href="#greypatch.get_object_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute object properties. EG. area.</p>
<p>Given a label array returns a list of computed RegionProperties objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>label_array np.ndarray -- the label array to compute properties from</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>intensity_image np.ndarray -- the image on which properties are computed</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of skimage.measure.regionprops objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.griffin_healthy_regions">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">griffin_healthy_regions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hsv_img</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">h</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.1568627450980392, 1.0</span></em>, <em class="sig-param"><span class="n">s</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.19607843137254902, 1.0</span></em>, <em class="sig-param"><span class="n">v</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.0, 1.0</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>int<span class="p">]</span><a class="headerlink" href="#greypatch.griffin_healthy_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Ciaran Griffin's Healthy Region extraction.</p>
<p>Given an image in hsv applies Ciaran Griffin's detection for healthy regions.
returns the mask of pixels and the pixel volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>hsv_img np.ndarray -- an HSV scaled image</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>h Tuple -- minimum and maximum Hue threshold values</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>s Tuple -- minimum and maximum Saturation threshold values</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>v Tuple -- minimum and maximum Value threshold values</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>np.ndarray, int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.griffin_leaf_regions">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">griffin_leaf_regions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hsv_img</span></em>, <em class="sig-param"><span class="n">h</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.0, 1.0</span></em>, <em class="sig-param"><span class="n">s</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.19607843137254902, 1.0</span></em>, <em class="sig-param"><span class="n">v</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.1568627450980392, 1.0</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>int<span class="p">]</span><a class="headerlink" href="#greypatch.griffin_leaf_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>given an image in hsv applies Ciaran Griffin's detection for leaf area regions.
applies a hsv_space colour threshold and fills that mask for holes.
returns a binary mask and object count.</p>
</dd></dl>

<dl class="py function">
<dt id="greypatch.griffin_lesion_centres">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">griffin_lesion_centres</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hsv_img</span></em>, <em class="sig-param"><span class="n">lesion_region</span><span class="p">:</span> <span class="n">skimage.measure._regionprops.RegionProperties</span></em>, <em class="sig-param"><span class="n">sigma</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">2.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#greypatch.griffin_lesion_centres" title="Permalink to this definition">¶</a></dt>
<dd><p>finds lesion centres in a given lesion region</p>
</dd></dl>

<dl class="py function">
<dt id="greypatch.griffin_lesion_regions">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">griffin_lesion_regions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hsv_img</span></em>, <em class="sig-param"><span class="n">h</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.0, 0.1607843137254902</span></em>, <em class="sig-param"><span class="n">s</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.14901960784313725, 1.0</span></em>, <em class="sig-param"><span class="n">v</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.43529411764705883, 1.0</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>int<span class="p">]</span><a class="headerlink" href="#greypatch.griffin_lesion_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>given an image in hsv applies Ciaran Griffin's detection for lesion regions.
applies a hsv_space colour threshold,
returns a labelled mask of objects and the object count.</p>
</dd></dl>

<dl class="py function">
<dt id="greypatch.griffin_scale_card">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">griffin_scale_card</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hsv_img</span></em>, <em class="sig-param"><span class="n">h</span></em>, <em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">side_length</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#greypatch.griffin_scale_card" title="Permalink to this definition">¶</a></dt>
<dd><p>returns pixels per cm of scale card object</p>
</dd></dl>

<dl class="py function">
<dt id="greypatch.hsv_to_rgb255">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">hsv_to_rgb255</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">img</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#greypatch.hsv_to_rgb255" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert HSV image to RGB image.</p>
<p>Given an HSV image in (0.0,1.0) range, converts to RGB image in (0,255). Usually needed prior to viewing as most viewers interpret images as RGB.</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>img np.ndarray -- a numpy ndarray</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>np.ndarray -- a numpy ndarray with shape == img</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.is_long_and_large">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">is_long_and_large</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span><span class="p">:</span> <span class="n">skimage.measure._regionprops.RegionProperties</span></em>, <em class="sig-param"><span class="n">major_to_minor</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">2</span></em>, <em class="sig-param"><span class="n">min_area</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">90000</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>bool<span class="p">]</span><a class="headerlink" href="#greypatch.is_long_and_large" title="Permalink to this definition">¶</a></dt>
<dd><p>&quot;
Work out whether an object is long and large.</p>
<p>Given a region props object works ; returns True if the object represented has a
major to minor axis ratio of &gt; major_to_minor and takes up pixels of min_area,
False otherwise and None if not calculable</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>obj skimage.measure._regionprops._RegionProperties -- a region properties object</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>major_to_minor int -- the ratio of the long to short side that defines whether the object is long</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>min_area int -- the total area that defines whether the object is large.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None or bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.is_not_small">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">is_not_small</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span><span class="p">:</span> <span class="n">skimage.measure._regionprops.RegionProperties</span></em>, <em class="sig-param"><span class="n">min_area</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">2500</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>bool<span class="p">]</span><a class="headerlink" href="#greypatch.is_not_small" title="Permalink to this definition">¶</a></dt>
<dd><p>&quot;
Work out whether an object is not small.</p>
<p>Given a region props object this function returns True if its area is greater than min_area.
False if not and None if the value is not calculable</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>obj skimage.measure._regionprops._RegionProperties -- a region properties object</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>min_area int -- minimum area threshold</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None or bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.label_image">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">label_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">structure</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">output</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>int<span class="p">]</span><a class="headerlink" href="#greypatch.label_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates labels for the objects in an image.</p>
<p>Given a binary mask array, returns a version with the distinct islands labelled by integers,
and a count of objects found. Thin wrapper around ndi.label</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>m np.ndarray -- binary mask image/array</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>structure np.ndarray -- custom structuring object if needed (default None)</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a labelled image mask</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.load_as_hsv">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">load_as_hsv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#greypatch.load_as_hsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a file into HSV colour space.</p>
<p>Takes a file path and opens the image then converts to HSV colour space.
returns numpy array dtype float 64. Strips the alpha (fourth) channel if it exists.
Input must be colour image. One channel images will be rejected.</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>fname str -- path to the image</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>np.ndarray -- numpy array containing image</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.pixel_volume_to_circular_area">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">pixel_volume_to_circular_area</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pixels</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">scale</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#greypatch.pixel_volume_to_circular_area" title="Permalink to this definition">¶</a></dt>
<dd><p>helps work out the area of a circular object with a similar pixel volume at the same scale
pixels = pixels in the object , scale = pixels per cm in this image, obtainable from rp.griffin_scale_card()</p>
<p>returns a float giving the area a circle of that number of pixels would take up</p>
</dd></dl>

<dl class="py function">
<dt id="greypatch.preview_hsv">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">preview_hsv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">img</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">width</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">height</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#greypatch.preview_hsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw an HSV image to screen.</p>
<p>Given an HSV image, generates a preview image and draws to screen.
Intended for use in IPython and interactive sessions as the plot renders immediately.</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>img np.ndarray -- the image to draw</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>width int -- width in inches of the plot</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>height int -- height in inches of the plot</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.preview_mask">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">preview_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">width</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">height</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#greypatch.preview_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a mask to screen.</p>
<p>Given a binary bool mask array draws a plot in two colours black = 1/True, white = 0/False.
Intended for use in IPython and interactive sessions as the plot renders immediately</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>m np.ndarray -- the mask to draw.</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>width int -- width in inches of the plot</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>height int -- height in inches of the plot</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.preview_object_labels">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">preview_object_labels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label_array</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">binary_image</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">width</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">height</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#greypatch.preview_object_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a preview image of objects in a mask, colouring by labels.</p>
<p>Given a labelled object array from rp.label_image and a background binary image, returns a plot with
the objects described in the labelled array coloured in.
Intended for use in IPython and interactive sessions as the plot renders immediately.</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>label_array np.ndarray -- labelled object array/image</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="greypatch.run_threshold_preview">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">run_threshold_preview</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">height</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">15</span></em>, <em class="sig-param"><span class="n">width</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">15</span></em>, <em class="sig-param"><span class="n">slider_width</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">500</span></em>, <em class="sig-param"><span class="n">perfect</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">scale</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.25</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#greypatch.run_threshold_preview" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an HSV image, generates some sliders and an overlay image. Shows the image colouring the
pixels that are included in the sliders thresholds in red. Note this does not return an image or
mask of those pixels, its just a tool for finding the thresholds</p>
<p>If <cite>perfect = False</cite> (default) the image is downsized by a factor in <cite>scale</cite> (default = 0.25) before running the thresholding.</p>
</dd></dl>

<dl class="py function">
<dt id="greypatch.threshold_hsv_img">
<code class="sig-prename descclassname">greypatch.</code><code class="sig-name descname">threshold_hsv_img</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">im</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">h</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.1568627450980392, 1.0</span></em>, <em class="sig-param"><span class="n">s</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.19607843137254902, 1.0</span></em>, <em class="sig-param"><span class="n">v</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.0, 1.0</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#greypatch.threshold_hsv_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects pixels passing an HSV image threshold in all three channels.</p>
<p>Returns a logical binary mask array (dtype bool of dimension im ( an HSV image) in which pixels in im pass the lower
and upper thresholds specified in h, s and v (hue lower,upper; sat lower,upper and val lower, upper;
respectively)</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>im np.ndarray -- a numpy ndarray</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>h Tuple -- a 2-tuple of Hue thresholds (lower, upper)</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>s Tuple -- a 2-tuple of Saturation thresholds (lower, upper)</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>v Tuple -- a 2-tuple of Value thresholds (lower, upper)</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>np.ndarray -- a logical array (dtype bool) with shape == im</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-filtersettings"></span><p>filtersettings</p>
<p>A module for creating filter settings for greypatch experiments</p>
<div class="section" id="id1">
<h2>Workflow Overview<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Create empty object</p></li>
<li><p>Add threshold settings for selecting different parts of the image</p></li>
<li><p>Write settings to file for re-use</p></li>
</ol>
</div>
<div class="section" id="id2">
<h2>Basic Usage<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Import module, create empty object</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">greypatch</span> <span class="k">as</span> <span class="nn">rp</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">FilterSettings</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Add some settings</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span><span class="o">.</span><span class="n">add_setting</span><span class="p">(</span><span class="s2">&quot;leaf_area&quot;</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span> <span class="n">v</span><span class="o">=</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Access a setting by name</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;leaf_area&quot;</span><span class="p">][</span><span class="s2">&quot;h&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<ol class="arabic" start="3">
<li><p>Write settings to a file</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;my_settings.yaml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Read in settings from a file</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">FilterSettings</span><span class="p">()</span>
<span class="n">settings</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;/some/file/settings.yaml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Create a default filter settings file</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">FilterSettings</span><span class="p">()</span>
<span class="n">fs</span><span class="o">.</span><span class="n">create_default_filter_file</span><span class="p">(</span><span class="s2">&quot;/some/folder/settings.yaml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<dl class="py class">
<dt id="filtersettings.FilterSettings">
<em class="property">class </em><code class="sig-prename descclassname">filtersettings.</code><code class="sig-name descname">FilterSettings</code><a class="headerlink" href="#filtersettings.FilterSettings" title="Permalink to this definition">¶</a></dt>
<dd><p>class representing groups of filter settings for different aspects of the image</p>
<dl class="py method">
<dt id="filtersettings.FilterSettings.add_setting">
<code class="sig-name descname">add_setting</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">h</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">()</span></em>, <em class="sig-param"><span class="n">s</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">()</span></em>, <em class="sig-param"><span class="n">v</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">()</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#filtersettings.FilterSettings.add_setting" title="Permalink to this definition">¶</a></dt>
<dd><p>add a setting to the object</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>tag str -- the name of the setting</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>h Tuple -- a 2-tuple of Hue thresholds (lower, upper)</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>s Tuple -- a 2-tuple of Saturation thresholds (lower, upper)</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>v Tuple -- a 2-tuple of Value thresholds (lower, upper)</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="filtersettings.FilterSettings.create_default_filter_file">
<code class="sig-name descname">create_default_filter_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'default_filter.yml'</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#filtersettings.FilterSettings.create_default_filter_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write a file containing the default filter settings
:param file str -- name of the file to write:
:return: None</p>
</dd></dl>

<dl class="py method">
<dt id="filtersettings.FilterSettings.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">infile</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#filtersettings.FilterSettings.read" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>infile str -- name of the file to read</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="filtersettings.FilterSettings.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outfile</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#filtersettings.FilterSettings.write" title="Permalink to this definition">¶</a></dt>
<dd><p>write the settings to a yaml file</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>file str -- name of the file to write</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-filebrowser"></span><p>FileBrowser</p>
<p>A module for creating interactive file browser widgets in a Jupyter notebook</p>
<div class="section" id="id3">
<h2>Workflow Overview<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Create object</p></li>
<li><p>Browse file interactively</p></li>
<li><p>Extract path of selected file</p></li>
</ol>
</div>
<div class="section" id="id4">
<h2>Basic Usage<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Import module and create widget</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">greypatch</span> <span class="k">as</span> <span class="nn">rp</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">FileBrowser</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Browse</p>
<blockquote>
<div><p>... interactively</p>
</div></blockquote>
</li>
<li><p>Extract path of selected file</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">path</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
<span class="target" id="module-report"></span><p>report</p>
<p>A module for creating greypatch run reports; used by 'greypatch-batch-process'</p>
<div class="section" id="id5">
<h2>Workflow Overview<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Create object, specify run folder, image objects and filter settings</p></li>
<li><p>Add calculated annotated sub images for images</p></li>
<li><p>write to html</p></li>
</ol>
</div>
<div class="section" id="id6">
<h2>Basic Usage<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Import module and create object</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">greypatch</span> <span class="k">as</span> <span class="nn">rp</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">FilterSettings</span><span class="p">()</span>
<span class="n">fs</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;settings.yml&quot;</span><span class="p">)</span>
<span class="n">source_folder</span> <span class="o">=</span> <span class="s2">&quot;some/folder&quot;</span>
<span class="n">image_files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;img1.jpg&quot;</span><span class="p">,</span> <span class="s2">&quot;img2.jpg]</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">RPReport</span><span class="p">(</span><span class="n">source_folder</span><span class="p">,</span> <span class="n">image_files</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Add subimages and annotations</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">report</span><span class="o">.</span><span class="n">add_subimages</span><span class="p">(</span><span class="n">image_file</span><span class="p">,</span> <span class="n">sub_image_tag</span><span class="p">)</span>
<span class="n">report</span><span class="o">.</span><span class="n">add_annotated_subimages</span><span class="p">(</span><span class="n">image_file</span><span class="p">,</span> <span class="n">sub_image_tag</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Write report and images to results folder</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;some/folder&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<dl class="py class">
<dt id="report.RPReport">
<em class="property">class </em><code class="sig-prename descclassname">report.</code><code class="sig-name descname">RPReport</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">source_directory</span></em>, <em class="sig-param"><span class="n">images</span></em>, <em class="sig-param"><span class="n">filter_settings</span></em><span class="sig-paren">)</span><a class="headerlink" href="#report.RPReport" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representing an HTML report page. Used by batch-process</p>
</dd></dl>

</div>
<span class="target" id="module-lesioncentre"></span><dl class="py class">
<dt id="lesioncentre.LesionCentre">
<em class="property">class </em><code class="sig-prename descclassname">lesioncentre.</code><code class="sig-name descname">LesionCentre</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rprop</span><span class="p">:</span> <span class="n">skimage.measure._regionprops.RegionProperties</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parent_rprop</span><span class="p">:</span> <span class="n">skimage.measure._regionprops.RegionProperties</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scale</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pixel_length</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_ratio</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">minimum_size</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prop_across_parent</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lesioncentre.LesionCentre" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a lesion centre.</p>
<p>Modifies a scikit RegionProp and requires information from a
parent RegionProp</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>rprop skimage.measure._regionprops._RegionProperties -- region to make a lesion centre</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>parent_rprop skimage.measure._regionprops._RegionProperties -- parent (enclosing) region of rprop</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>scale float -- measure of the scale of the image, either None (scale in image pixels) or real units from scale card</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>pixel_length -- length of side of one pixel, available when scale</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>max_ratio float -- threshold of region length / width to pass filter</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>minimum_size float -- minimum size to pass filter. calculated in units of scale</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>prop_across_parent float -- proportion of width of enclosing object the lesion centre must be to pass filter. EG 0.1 indicates that the lesion centre must be greater than 10 percent of the current width across the parent object</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-subimage"></span><dl class="py class">
<dt id="subimage.SubImage">
<em class="property">class </em><code class="sig-prename descclassname">subimage.</code><code class="sig-name descname">SubImage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sub_i</span></em>, <em class="sig-param"><span class="n">sub_i_idx</span></em>, <em class="sig-param"><span class="n">parent_image_file</span></em>, <em class="sig-param"><span class="n">file_settings</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dest_folder</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_lesion_area</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pixel_length</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_lc_ratio</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_lc_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lc_prop_across_parent</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#subimage.SubImage" title="Permalink to this definition">¶</a></dt>
<dd><p>class representing sub-image (leaf containing area) of a larger image.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sub_i</strong> -- the subimage</p></li>
<li><p><strong>sub_i_idx</strong> -- the index of the subimage from the subimage list</p></li>
<li><p><strong>scale</strong> -- the scale of the image if computed</p></li>
<li><p><strong>pixel_length</strong> -- the length of a pixel side in real units</p></li>
<li><p><strong>imtag</strong> -- the name of the file this subimage is referred to in the output</p></li>
<li><p><strong>annot_imtag</strong> -- the name of the annotated image file this subimage is referred to in the output</p></li>
<li><p><strong>parent_image_file</strong> -- the name of the file this subimage is derived from</p></li>
<li><p><strong>healthy_obj_props</strong> -- list of HealthyAreas found in the subimage</p></li>
<li><p><strong>leaf_area_props</strong> -- list of LeafAreas found in the subimage</p></li>
<li><p><strong>lesion_area_props</strong> -- list of LesionAreas found in the subimage</p></li>
<li><p><strong>lesion_centre_props</strong> -- list of LesionCentres found in the subimage</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="subimage.SubImage.create_results_dataframe">
<code class="sig-name descname">create_results_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">on_webserver</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#subimage.SubImage.create_results_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>generates a pandas dataframe of results from the SubImage object
:return: pandas.dataframe</p>
</dd></dl>

<dl class="py method">
<dt id="subimage.SubImage.write_annotated_sub_image">
<code class="sig-name descname">write_annotated_sub_image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#subimage.SubImage.write_annotated_sub_image" title="Permalink to this definition">¶</a></dt>
<dd><p>create output annotated subimage jpeg with results overlay
:return: None</p>
</dd></dl>

<dl class="py method">
<dt id="subimage.SubImage.write_sub_image">
<code class="sig-name descname">write_sub_image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#subimage.SubImage.write_sub_image" title="Permalink to this definition">¶</a></dt>
<dd><p>write out subimage (nonannotated)
:return: None</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="subimage.get_sub_images">
<code class="sig-prename descclassname">subimage.</code><code class="sig-name descname">get_sub_images</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imfile</span></em>, <em class="sig-param"><span class="n">file_settings</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dest_folder</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_lesion_area</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pixel_length</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_lc_ratio</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_lc_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lc_prop_across_parent</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#subimage.get_sub_images" title="Permalink to this definition">¶</a></dt>
<dd><p>extracts different leaves from a single image file, returning them as individual SubImage objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>imfile str -- path to the image</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>file_settings str -- FilterSettings object with image segmentation options</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>dest_folder str -- folder in which to place results files</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>min_lesion_area float -- minimum area for a lesion to pass filter. In either pixels or actual size if 'scale' passed</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>scale float -- pixels per real unit length, if known or computed earlier.</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>max_lc_ratio float -- maximum length/width ratio of lesion centre to pass filter</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>min_lc_size float -- minimum lesion centre size. Computed in real units if 'scale' passed. Computed as area of circle with same pixel volume as the centre.</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>lc_prop_across_parent float -- minimum proportion lesion centre must be across the width of the parent lesion (in the row the centre centroid occurs) to pass filter</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-imagearea"></span><dl class="py class">
<dt id="imagearea.HealthyArea">
<em class="property">class </em><code class="sig-prename descclassname">imagearea.</code><code class="sig-name descname">HealthyArea</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rprop</span></em>, <em class="sig-param"><span class="n">scale</span></em>, <em class="sig-param"><span class="n">pixel_length</span></em><span class="sig-paren">)</span><a class="headerlink" href="#imagearea.HealthyArea" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="imagearea.ImageArea">
<em class="property">class </em><code class="sig-prename descclassname">imagearea.</code><code class="sig-name descname">ImageArea</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rprop</span></em>, <em class="sig-param"><span class="n">scale</span></em>, <em class="sig-param"><span class="n">pixel_length</span></em><span class="sig-paren">)</span><a class="headerlink" href="#imagearea.ImageArea" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for image areas that are created by rp.get_subimages()
Copies user attributes from skimage.measure.regionprops and
adds a few attributes</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> -- computed size of area if scale is provided in cm2</p></li>
<li><p><strong>passed</strong> -- computed filter pass/fail. Can be NA if area does not have filter criteria</p></li>
<li><p><strong>parent_lesion_region</strong> -- ID of parent (enclosing region) where exists</p></li>
<li><p><strong>prop_across_parent</strong> -- computed distance across parent region width a lesion centre falls. Is NA for other regions</p></li>
<li><p><strong>subimage_centre</strong> -- centre pixels of image area</p></li>
</ul>
</dd>
<dt class="field-even">Scale</dt>
<dd class="field-even"><p>scale of the image</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>pixel_length -- length of side of one pixel, available when scale</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="imagearea.LeafArea">
<em class="property">class </em><code class="sig-prename descclassname">imagearea.</code><code class="sig-name descname">LeafArea</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rprop</span></em>, <em class="sig-param"><span class="n">scale</span></em>, <em class="sig-param"><span class="n">pixel_length</span></em><span class="sig-paren">)</span><a class="headerlink" href="#imagearea.LeafArea" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="imagearea.LesionArea">
<em class="property">class </em><code class="sig-prename descclassname">imagearea.</code><code class="sig-name descname">LesionArea</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rprop</span></em>, <em class="sig-param"><span class="n">scale</span></em>, <em class="sig-param"><span class="n">pixel_length</span></em>, <em class="sig-param"><span class="n">min_lesion_area</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#imagearea.LesionArea" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">greypatch</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Dan MacLean and Ciaran Griffin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>